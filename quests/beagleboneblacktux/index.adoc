// rvm use 2.1@runtime
// asciidoctor -D /tmp/ -a data-uri -a stem user-manual.adoc
= Exploring Embedded Linux With The BeagleBone Black
Conrad Gomes <conrad.s.j.gomes@gmail.com>
:description: This is a journal of my experience with BeagleBone Black
:keywords: BeagleBone Black
:doctype: book
:compat-mode:
//:page-layout!:
:page-layout: base
//:toc: left
:toc: macro
:toclevels: 2
:toc-title: Table of Contents
:sectanchors:
:sectlinks:
:sectnums:
:linkattrs:
:icons: font
:source-highlighter: coderay
:source-language: asciidoc
:experimental:
:stem:
:idprefix:
:idseparator: -
:ast: &ast;
:dagger: pass:normal[^&dagger;^]
:y: icon:check[role="green"]
:n: icon:times[role="red"]
:c: icon:file-text-o[role="blue"]
:table-caption!:
:example-caption!:
:figure-caption!:
:imagesdir: images
:includedir: _includes
:underscore: _
// Refs
:uri-conrad-mail: mailto:conrad.s.j.gomes@gmail.com
:uri-linux-foundation: http://www.linuxfoundation.org/
:uri-free-electrons: http://free-electrons.com/
:uri-beagleboard: http://beagleboard.org/
:uri-raspberry-pi: http://www.raspberrypi.org/
:uri-ubuntu: http://www.ubuntu.com/
:uri-oracle-virtualbox: https://www.virtualbox.org/
:uri-vmware: http://www.vmware.com
:uri-git-scm: http://git-scm.com/
:uri-kernel-org: https://www.kernel.org/
:uri-linux-mtd-org: http://www.linux-mtd.infradead.org/index.html
:uri-linux-mtd-git: git://git.infradead.org/linux-mtd.git
:uri-linux-mips-org: http://www.linux-mips.org/wiki/Main_Page
:uri-linux-mips-git: git://git.linux-mips.org/pub/scm/ralf/linux.git
:uri-linux-usb-org: http://www.linux-usb.org/
:uri-linux-usb-git: git://git.kernel.org/pub/scm/linux/kernel/git/gregkh/patches.git
:link-beagleboneblack-srm-pdf: link:docs/BBB_SRM.pdf

:compat-mode!:

toc::[]


[NOTE]
.This document is under active development!
====
If you find errors or omissions in this document, please don't hesitate to {uri-conrad-mail}[send me a mail].
====

This journal assumes you are comfortable with a linux environment as most of the
published work here uses an Ubuntu distribution as the work station.


= Introduction

[partintro]
--
This journal was started in order to document my exploration of embedded linux
using a popular low-cost platform i.e. the BeagleBone Black. The end objective 
is to become well versed with embedded linux development on an ARM based embedded
device. 
--
== About The Linux Kernel

"I'm doing a (free) operating system (just a hobby, won't be big and
professional like gnu) for 386(486) AT clones. This has been brewing
since April and is starting to get ready. I'd like any feedback on things
people like/dislike in minix, as my OS resembles it somewhat (same physical
layout of the file-system (due to practical reasons) among other things)."
-- Linus Torvald: 25th August 1991

The Linux kernel started off as a hobby project and by a Finnish
national Linus Torvalds. It is today the OS powering the largest number of
computers on the planet. It is used in phones, tablets, laptops, netbooks,
routers, desktops, servers, supercomputers, embedded devices, consumer
electronics, etc.

The development of the Linux kernel is carried out by an army of dynamic
open source developers, the majority of which comprise of hobbyists. 
Significant contribution to the kernel is now coming from companies using
the kernel. The development is still spearheaded by Linus who is employed
by the {uri-linux-foundation}[Linux Foundation^].


== About BeagleBoard
{uri-beagleboard}[BeagleBoard.org Foundation^] is a non-profit corporation which
promotes open source software and open hardware. It was started by enthusiasts
from TI with the aim of providing a powerful platform to design embedded solutions.
The BeagleBone Black is their fourth board till date which offers a lot of 
possibilities in a small credit card size form factor.

== About Free Electrons
{uri-free-electrons}[Free Electrons^] is an engineering company consisting of
embedded linux experts who support companies using Embedded Linux. They 
additionally conduct training workshops for companies on different topics 
such as Linux kernel and device driver development, Android system development, 
Yocto Project and OpenEmbedded development, etc. This journal uses the Free 
Electrons training material which they publish online to explore Embedded Linux
with the BeagleBone Black board from TI.

= Training and Workbench Setup

[partintro]
--
This section covers the setup software and hardware used in this journal.
The sources of the training material and references are mentioned as well
as details about how to procure the hardware.
--

== Hardware

=== BeagleBone Black

The BeagleBone Black is the newest member in the BeagleBoard family. The board 
is designed to be a low sized small form factor board. The size of the board
is comparable to the size of a credit card and it offers expansion headers to 
add headers called as capes similar to the {uri-raspberry-pi}[Raspberry Pi^].

====
image::BeagleBoneBlackREV_A5A.jpg[width="640", height="480", align="center"]
====

The table below highlights the key onboard components of the board along with
the connectors available on the board. The diagram of the table below is taken
from the {link-beagleboneblack-srm-pdf}[BeagleBone Black System Reference Manual^].

====
image::BeagleBoneBlackFeatures.jpg[width="640", height="480", align="center"]
====

== Software

=== Ubuntu

To work with an embedded system you need a work station on which you can
perform the various tasks that are required in the development life cycle.
These tasks include:

. Editing your build scripts and source code
. Cross-compiling your source code for the embedded target
. Transferring or accessing the cross-compiled application and libraries
to or from the embedded target 
. Collecting debug information from the target
. Communicating with the target remotely using its interfaces like
serial, USB, network, etc..

In this document we use the popular Debian based Linux operating system,
{uri-ubuntu}[Ubuntu] as our work station for all the tasks listed above.
Ubuntu can be easily downloaded and installed on any PC or laptop. 

[IMPORTANT]
.Do not use a virtual machine runnning Ubuntu as your workstation 
====
This document uses Ubuntu 14.04 running on a HP laptop. Use of a similar
environment through a virtual machine runnning on {uri-vmware}[VMWare^] or
{uri-oracle-virtualbox}[Oracle VirtualBox^] is
not recommended.
====

=== GIT

The source code management tool used by the Linux kernel community is 
{uri-git-scm}[GIT^]. To use GIT we need to install the packages required
on our work station using the Advanced Packaging Tool(APT) using a 
command line terminal.

[source,bash]
----
conrad@conrad-HP-Pavilion-dm3-Notebook-PC:~$ sudo apt-get install git gitk git-email
----

Once the packages are successfully installed we will need to configure GIT with
some basic information about our name and email address

[source,bash]
----
conrad@conrad-HP-Pavilion-dm3-Notebook-PC:~$ git config --global user.name Conrad Gomes
conrad@conrad-HP-Pavilion-dm3-Notebook-PC:~$ git config --global user.email conrad.s.j.gomes@gmail.com
----

Further infomation about GIT can be obtained at: +
{uri-git-scm}[{uri-git-scm}^].

=== Cloning the Linux tree with GIT

Now that GIT is present in the workstation we can get the main development tree
of the Linux kernel as follows:

[source,bash]
----
conrad@conrad-HP-Pavilion-dm3-Notebook-PC:~$ git clone git://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git
----

And if you're in a corporarte environment or if your firewall blocks out the 
network port for _git_ you can use _http_ instead as follows:

[source,bash]
----
conrad@conrad-HP-Pavilion-dm3-Notebook-PC:~$ git clone http://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git
----

The whole process should take a while so you can go for a small coffee break
and come back. Comparitively using _git_ is recommended as it is faster than
_http_

If you happen to have a copy of the Linux GIT repository all you have to do
is pull in the latest changes

[source,bash]
----
conrad@conrad-HP-Pavilion-dm3-Notebook-PC:~$ cd ~/git/linux
conrad@conrad-HP-Pavilion-dm3-Notebook-PC:~/git/linux$ git checkout master
conrad@conrad-HP-Pavilion-dm3-Notebook-PC:~/git/linux$ git pull
----

Once you have the Linux GIT repository you can pull the latest changes by 
by running _git pull_.

= The Kernel Source Code

[partintro]
--
This section covers details about the Linux Kernel source code. We will go through
the source code, its structure and characteristics.
--

== Offical and Unofficial Kernel Sources

The official source of the Linux Kernel is available at: +
{uri-kernel-org}[{uri-kernel-org}^]

The sources present in this website do not represent the entire spectrum of
features and development that is taking place. Since the kernel is logically
divided into sub-systems, each sub-system is maintained by a designated
individual who has been involved with the sub-system and is trusted by Linus.
So when the merge window opens these individuals who are termed as "maintainers"
send pull requests to Linus to take in the patches from their repositories for
merging with the mainline kernel tree. In some cases if the subsystem is large
it may be divided into smaller subsystems which are managed by individuals
designated as "sub-maintainers".

The official development repository for some sub-systems are given below:

. MTD +
*Website:* {uri-linux-mtd-org}[{uri-linux-mtd-org}^] +
*GIT:* {uri-linux-mtd-git}

. MIPS +
*Website:* {uri-linux-mips-org}[{uri-linux-mips-org}^] +
*GIT:* {uri-linux-mips-git}

. USB +
*Website:* {uri-linux-usb-org}[{uri-linux-usb-org}^] +
*GIT:* {uri-linux-usb-git}

