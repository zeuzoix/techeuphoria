<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1.0" name="viewport">
<title>A Technical Odyssey</title>
<link href="http://zeuzoix.github.io/techeuphoria/stylesheets/app.css" rel="stylesheet">
<link href="/techeuphoria/feed.xml" rel="alternate" type="application/atom+xml">
<script src="http://zeuzoix.github.io/techeuphoria/javascripts/vendor/custom.modernizr.js"></script>
<link href="http://zeuzoix.github.io/techeuphoria/humans.txt" rel="author" type="text/plain">
</head>
<body class="antialiased">
<div class="fixed-width">
<nav class="top-bar">
<ul class="title-area">
<li class="name">
<h1>
<a href="/techeuphoria/">
TechEuphoria
</a>
</h1>
</li>
<li class="toggle-topbar menu-icon">
<a href="#"><span></span></a>
</li>
</ul>
<section class="top-bar-section">
<ul class="left">
<li class="divider">
<li>
<a href="/techeuphoria/quests/index.html">/quests</a>
</li>
</li>
<li class="divider"></li>
</ul>
</section>
</nav>
</div>
<div class="row">
<div class="large-12 columns">
<h1></h1>
</div>
</div>
<div class="row" id="content">
<div class="large-12 columns">
<article class="post">
<header class="post-head">
<h1 class="title">
<a href="/techeuphoria/posts/2015/02/06/imx28-ltib-bsp-build-part2/">Building The i.MX28 Board Support Package (BSP) With LTIB - Part 2</a>
</h1>
<h4>
<em>by</em>
<a class="author" href="http://in.linkedin.com/in/conradsjgomes">
Conrad Gomes
</a>
on
<time class="pubdate" datetime="2015-02-06T00:00:00+00:00">
February  6, 2015
</time>
</h4>
</header>
<div class="post-body">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In the first part we worked on getting LTIB configured for our machine. We ran into alot of problems but fixed each problem after a bit of online reading. In this part we attempt to actually build the bootloaders, kernel and applications with LTIB which will comprise the BSP</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuring-ltib-for-i-mx28"><a class="anchor" href="#configuring-ltib-for-i-mx28"></a>Configuring LTIB for i.MX28</h2>
<div class="sectionbody">
<div class="paragraph">
<p>LTIB Offers a lot of flexibility in choosing the type of embedded system that
is required for the platform. Depending on the use case different aspects can
be configured using <em>ltib</em>.</p>
</div>
<div class="sect2">
<h3 id="selecting-the-platform"><a class="anchor" href="#selecting-the-platform"></a>Selecting The Platform</h3>
<div class="paragraph">
<p>On running <em>ltib</em> it will display the ncurses dialog which is used to select
the desired platform. In our case it is Freescale iMX reference boards as shown
below:</p>
</div>
<div class="exampleblock">
<div class="content">
<div id="imx28-ltib-bsp-build-freescale-ncurses-platform-selection" class="imageblock" style="text-align: center">
<div class="content">
<a class="image" href="../../../../../images/imx28-ltib-bsp-build-freescale-ncurses-platform-selection.png"><img src="http://zeuzoix.github.io/techeuphoria/images/imx28-ltib-bsp-build-freescale-ncurses-platform-selection.png" alt="imx28 ltib bsp build freescale ncurses platform selection" width="640" height="480"></a>
</div>
<div class="title">Figure 1. Ncurses screen with platform selection</div>
</div>
</div>
</div>
<div class="paragraph">
<p>On exiting it will ask you if you want to save the configuration. Make sure
"yes" is selected and then exit:</p>
</div>
<div class="exampleblock">
<div class="content">
<div id="imx28-ltib-bsp-build-freescale-ncurses-save-new-configuration" class="imageblock" style="text-align: center">
<div class="content">
<a class="image" href="../../../../../images/imx28-ltib-bsp-build-freescale-ncurses-save-new-configuration.png"><img src="http://zeuzoix.github.io/techeuphoria/images/imx28-ltib-bsp-build-freescale-ncurses-save-new-configuration.png" alt="imx28 ltib bsp build freescale ncurses save new configuration" width="640" height="480"></a>
</div>
<div class="title">Figure 2. Saving the new configuration</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="selecting-the-freescale-platform-type-and-profile"><a class="anchor" href="#selecting-the-freescale-platform-type-and-profile"></a>Selecting The Freescale Platform Type And Profile</h3>
<div class="paragraph">
<p>It will then ask you to select the type of Freescale as i.MX28 development platform</p>
</div>
<div class="exampleblock">
<div class="content">
<div id="imx28-ltib-bsp-build-freescale-ncurses-select-mx28-platform-chose-platform" class="imageblock" style="text-align: center">
<div class="content">
<a class="image" href="../../../../../images/imx28-ltib-bsp-build-freescale-ncurses-select-mx28-platform-chose-platform.png"><img src="http://zeuzoix.github.io/techeuphoria/images/imx28-ltib-bsp-build-freescale-ncurses-select-mx28-platform-chose-platform.png" alt="imx28 ltib bsp build freescale ncurses select mx28 platform chose platform" width="640" height="480"></a>
</div>
<div class="title">Figure 3. Selecting the type of development platform as imx28</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Also select the package profile. We select the "(Min profile)"</p>
</div>
<div class="exampleblock">
<div class="content">
<div id="imx28-ltib-bsp-build-freescale-ncurses-select-mx28-platform-type-preconfig-min-profile" class="imageblock" style="text-align: center">
<div class="content">
<a class="image" href="../../../../../images/imx28-ltib-bsp-build-freescale-ncurses-select-mx28-platform-type-preconfig-min-profile.png"><img src="http://zeuzoix.github.io/techeuphoria/images/imx28-ltib-bsp-build-freescale-ncurses-select-mx28-platform-type-preconfig-min-profile.png" alt="imx28 ltib bsp build freescale ncurses select mx28 platform type preconfig min profile" width="640" height="480"></a>
</div>
<div class="title">Figure 4. Selecting the type of profile as "Min profile"</div>
</div>
</div>
</div>
<div class="paragraph">
<p>On exiting it will ask you if you want to save the configuration. Make sure
"yes" is selected and then exit:</p>
</div>
<div class="exampleblock">
<div class="content">
<div id="imx28-ltib-bsp-build-freescale-ncurses-platform-selection-save-new-configuration" class="imageblock" style="text-align: center">
<div class="content">
<a class="image" href="../../../../../images/imx28-ltib-bsp-build-freescale-ncurses-platform-selection-save-new-configuration.png"><img src="http://zeuzoix.github.io/techeuphoria/images/imx28-ltib-bsp-build-freescale-ncurses-platform-selection-save-new-configuration.png" alt="imx28 ltib bsp build freescale ncurses platform selection save new configuration" width="640" height="480"></a>
</div>
<div class="title">Figure 5. Saving the new configuration of development platform</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configuring-the-freescale-i-mx28-board-package"><a class="anchor" href="#configuring-the-freescale-i-mx28-board-package"></a>Configuring The Freescale i.MX28 Board Package</h3>
<div class="paragraph">
<p>We see the ncurses configuration page for the i.MX28 board. From here the various
features of the board can be configured.</p>
</div>
<div class="exampleblock">
<div class="content">
<div id="imx28-ltib-bsp-build-freescale-ncurses-mx28-board-configuration" class="imageblock" style="text-align: center">
<div class="content">
<a class="image" href="../../../../../images/imx28-ltib-bsp-build-freescale-ncurses-mx28-board-configuration.png"><img src="http://zeuzoix.github.io/techeuphoria/images/imx28-ltib-bsp-build-freescale-ncurses-mx28-board-configuration.png" alt="imx28 ltib bsp build freescale ncurses mx28 board configuration" width="640" height="480"></a>
</div>
<div class="title">Figure 6. Saving and exiting without modifying the default configuration</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="default-build"><a class="anchor" href="#default-build"></a>Default Build</h3>
<div class="paragraph">
<p>The configuration loaded can be built without modifying it. We can take a look
and see what&#8217;s happening just by hitting exit and running the <em>LTIB</em> build. The
steps are hit <em>exit</em>. Then save the configuration when prompted on the ncurses
screen. We see is a failure to build of the kind:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">Installing: gcc-4.6.2-glibc-2.13-linaro-multilib-2011.12-1.i386.rpm
Try gcc-4.6.2-glibc-2.13-linaro-multilib-2011.12-1.i386.rpm.md5 from the PPP  <i class="conum" data-value="1"></i><b>(1)</b>
Try gcc-4.6.2-glibc-2.13-linaro-multilib-2011.12-1.i386.rpm.md5 from the GPP
http://bitshrine.org/gpp/gcc-4.6.2-glibc-2.13-linaro-multilib-2011.12-1.i386.rpm.md5:
22:44:07 ERROR 404: Not Found.
Try gcc-4.6.2-glibc-2.13-linaro-multilib-2011.12-1.i386.rpm from the PPP
Try gcc-4.6.2-glibc-2.13-linaro-multilib-2011.12-1.i386.rpm from the GPP
http://bitshrine.org/gpp/gcc-4.6.2-glibc-2.13-linaro-multilib-2011.12-1.i386.rpm:
22:44:08 ERROR 404: Not Found.
Can't get: gcc-4.6.2-glibc-2.13-linaro-multilib-2011.12-1.i386.rpm at ./ltib line 2560.   <i class="conum" data-value="2"></i><b>(2)</b>
Died at ./ltib line 2560.
traceback:
 main::check_toolchain_setup:2560
  main::pre_build_checks:1465
   main:569


Started: Tue Feb 10 22:25:52 2015
Ended:   Tue Feb 10 22:44:08 2015
Elapsed: 1096 seconds


Build Failed

Exiting on error or interrupt</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>It looks like the toolchain is not found in the PPP and GPP after trying to install it from the local cache</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <em>LTIB</em> build fails</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For further information about PPP and GPP please check out the following link:<br>
<a href="http://www.bitshrine.org/autodocs/LtibFaq.html#ref_95" target="_blank">Where do the sources get downloaded from</a></p>
</div>
</div>
<div class="sect2">
<h3 id="selecting-the-right-toolchain"><a class="anchor" href="#selecting-the-right-toolchain"></a>Selecting The Right Toolchain</h3>
<div class="paragraph">
<p>The toolchain is the set of tools including the cross-compiler which is required
to build the BSP for development on the desired target. By default the toolchain
selected is <em>ARM, gcc-4.6.2, multilib, neon optimized, gnueabi/eglibc2.13</em>. We
have to change this to <em>ARM, gcc-4.4.4, multilib, neon optimized</em> which is the
correct one available in the <em>LTIB</em> system. Run the following to bring up the
ncurses configuration page:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">ubuntu@ubuntu-VirtualBox:~/beta/projectX/ltib$ ./ltib --configure</code></pre>
</div>
</div>
<div class="paragraph">
<p>With that go to the "Toolchain selection" section and hit <em>Enter</em> on the default
option which is <em>Toolchain (ARM, gcc-4.6.2, multilib, neon optimized, gnueabi/eglibc2.13)</em>
We see a pop up with a list of toolchains. Select the <em>ARM, gcc-4.4.4, multilib, neon optimized</em>
option.</p>
</div>
<div class="exampleblock">
<div class="content">
<div id="imx28-ltib-bsp-build-freescale-ncurses-mx28-toolchain-selection" class="imageblock" style="text-align: center">
<div class="content">
<a class="image" href="../../../../../images/imx28-ltib-bsp-build-freescale-ncurses-mx28-toolchain-selection"><img src="http://zeuzoix.github.io/techeuphoria/images/imx28-ltib-bsp-build-freescale-ncurses-mx28-toolchain-selection.png" alt="imx28 ltib bsp build freescale ncurses mx28 toolchain selection" width="640" height="480"></a>
</div>
<div class="title">Figure 7. Selecting the appropriate toolchain</div>
</div>
</div>
</div>
<div class="paragraph">
<p>On exiting we see the BSP being built which takes some time to complete. This is
a test and development profile BSP which is built so it may not be exactly what
is required for your target.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">sudo /opt/freescale/ltib/usr/bin/rpm --root /home/ubuntu/beta/projectX/ltib/rootfs --dbpath /var/lib/rpm -e --allmatches --nodeps --define '_tmppath /tmp/ltib' modeps 2&gt;/dev/null
sudo /opt/freescale/ltib/usr/bin/rpm --root /home/ubuntu/beta/projectX/ltib/rootfs --dbpath /var/lib/rpm --prefix / --ignorearch -ivh --force --excludedocs --define '_tmppath /tmp/ltib' /home/ubuntu/beta/projectX/ltib/rpm/RPMS/arm/modeps-1.0-1.arm.rpm
error: failed to stat /run/user/110/gvfs: Permission denied
Preparing...                ########################################### [100%]
   1:modeps                 ########################################### [100%]

Processing deployment operations
==================================
making filesystem image file
staging directory is /home/ubuntu/beta/projectX/ltib/rootfs.tmp
removing the boot directory and files
removing man files and directories
removing info files
removing /usr/share/locale directory
removing static libraries
removing target rpm database
stripping binaries and libraries

Filesystem stats, including padding:

    Total size            = 15040k
    Total number of files = 1293


Started: Wed Feb 11 04:30:28 2015
Ended:   Wed Feb 11 04:45:46 2015
Elapsed: 918 seconds

Build Succeeded</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="exploring-the-built-bsp"><a class="anchor" href="#exploring-the-built-bsp"></a>Exploring The Built BSP</h3>
<div class="paragraph">
<p>After building, <em>LTIB</em> will generate the following in the <em>rootfs/boot/</em>
directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">ubuntu@ubuntu-VirtualBox:~/beta/projectX/ltib$ ls -l rootfs/boot/
total 19784
lrwxrwxrwx 1 root root       6 Feb 11 04:42 bootable_kernel -&gt; uImage
-rwxr-xr-x 1 root root   50960 Feb 11 04:45 boot_prep
-rwxr-xr-x 1 root root     803 Feb 11 04:45 create_updater.sh
-rw-r--r-- 1 root root 2586880 Feb 11 04:45 imx28_ivt_linux.sb       <i class="conum" data-value="1"></i><b>(1)</b>
-rw-r--r-- 1 root root  141184 Feb 11 04:45 imx28_ivt_uboot.sb       <i class="conum" data-value="2"></i><b>(2)</b>
-rw-r--r-- 1 root root 2586688 Feb 11 04:45 imx28_linux.sb           <i class="conum" data-value="3"></i><b>(3)</b>
-rw-r--r-- 1 root root  141040 Feb 11 04:45 imx28_uboot.sb           <i class="conum" data-value="4"></i><b>(4)</b>
-rw-r--r-- 1 root root   52953 Feb 11 04:42 linux.config
-rwxr-xr-x 1 root root   14855 Feb 11 04:45 linux_prep
-rwxr-xr-x 1 root root   57469 Feb 11 04:45 power_prep
-rw-r--r-- 1 root root 1224927 Feb 11 04:42 System.map
-rwxr-xr-x 1 root root  518068 Feb 11 04:33 u-boot
-rwxr-xr-x 1 root root  123572 Feb 11 04:33 u-boot.bin
-rw-r--r-- 1 root root 2566320 Feb 11 04:42 uImage                   <i class="conum" data-value="5"></i><b>(5)</b>
-rw-r--r-- 1 root root    1236 Feb 11 04:45 updater.bd
-rw-r--r-- 1 root root    1421 Feb 11 04:45 updater_ivt.bd
-rwxr-xr-x 1 root root 7523413 Feb 11 04:42 vmlinux                  <i class="conum" data-value="6"></i><b>(6)</b>
-rwxr-xr-x 1 root root 2566256 Feb 11 04:42 zImage                   <i class="conum" data-value="7"></i><b>(7)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The HAB enabled bootstream of bootlets and kernel image</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The HAB enabled bootstream of bootloet and uboot image</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The HAB disabled bootstream of bootlets and kernel image</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The HAB disabled bootstream of bootloet and uboot image</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The uboot compatible kernel image</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>The ELF format kernel image</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>The compressed self extracting image of the kernel</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The application rootfs is generated in the top directory of <em>ltib</em>
as a JFFS2 filesystem image which can be flashed onto a NAND partition.
The filesystem format can be changed to EXT2/EXT3/etc.. by changing the
configuration of the <em>LTIB</em> build.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">ubuntu@ubuntu-VirtualBox:~/beta/projectX/ltib$ ls -l
total 5308
drwxrwxrwx  2 ubuntu ubuntu    4096 Feb 11 03:49 bin
drwxrwxrwx  6 ubuntu ubuntu    4096 Feb 11 04:30 config
-rwxrwxrwx  1 ubuntu ubuntu   17989 Jan  8  2013 COPYING
drwxrwxrwx  3 ubuntu ubuntu    4096 Jan  8  2013 dist
drwxrwxrwx  2 ubuntu ubuntu    4096 Jan  8  2013 doc
-rwxrwxrwx  1 ubuntu ubuntu      41 Jan 30  2013 hash
-rw-rw-r--  1 ubuntu ubuntu    1366 Feb 11 04:30 host_config.log
-rwxrwxrwx  1 ubuntu ubuntu  106077 Jan  8  2013 ltib
-rwxrwxrwx  1 ubuntu ubuntu     952 Jan  8  2013 README
-rw-rw-r--  1 ubuntu ubuntu     227 Feb 11 04:45 RELEASE_INFO
drwxrwxr-x 17 ubuntu ubuntu    4096 Feb 11 04:42 rootfs
lrwxrwxrwx  1 ubuntu ubuntu      14 Feb 11 04:45 rootfs_image -&gt; ./rootfs.jffs2
-rw-r--r--  1 ubuntu ubuntu 5242880 Feb 11 04:45 rootfs.jffs2        <i class="conum" data-value="1"></i><b>(1)</b>
drwxrwxr-x  7 ubuntu ubuntu    4096 Feb 11 04:32 rpm
drwxrwxr-x  2 ubuntu ubuntu    4096 Feb 11 04:45 tmp
drwxrwxr-x  2 ubuntu ubuntu    4096 Feb  4 04:38 ubuntu-ltib-patch</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>JFFS2 image of rootfs</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>With that we have completed building our first BSP with <em>LTIB</em></p>
</div>
</div>
</div>
</div>
</div>
<footer class="post-footer">
<div class="tags"><i class="label icon-tags"></i>
<a href="/techeuphoria/posts/tag/linux/">linux</a>
, <a href="/techeuphoria/posts/tag/i.mx28/">i.mx28</a></div>
</footer>
<hr>
</article>


</div>
</div>
<footer class="row" style="max-width: 100%">
<hr>
<div class="large-6 columns">
<p style="margin-bottom: .75em">
&copy; conrad.s.j.gomes@gmail.com 2015
<br>
Built on Foundation. Baked by Awestruct. Composed with Asciidoc
</p>
</div>
<div class="large-6 columns">
<ul class="inline-list right">
<li>
<a href="http://zeuzoix.github.io/techeuphoria/">Home</a>
</li>
</ul>
</div>
</footer>
<script>
document.write('<script src=' + ('__proto__' in {} ? 'http://zeuzoix.github.io/techeuphoria/javascripts/vendor/zepto' : 'http://zeuzoix.github.io/techeuphoria/javascripts/vendor/jquery') + '.js><\/script>')
</script>
<script src="http://zeuzoix.github.io/techeuphoria/javascripts/foundation/foundation.js"></script>
<script src="http://zeuzoix.github.io/techeuphoria/javascripts/foundation/foundation.topbar.js"></script>
<script>
$(document).foundation()
</script>
</body>
</html>
